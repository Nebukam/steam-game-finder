"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _get(e,t,i){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,i){var s=_superPropBase(e,t);if(s){var a=Object.getOwnPropertyDescriptor(s,t);return a.get?a.get.call(i):a.value}})(e,t,i||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var i=_getPrototypeOf(e),s;if(t){var a=_getPrototypeOf(this).constructor;s=Reflect.construct(i,arguments,a)}else s=i.apply(this,arguments);return _possibleConstructorReturn(this,s)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(){function r(e,t,i){function o(a,n){if(!t[a]){if(!e[a]){var l="function"==typeof __r__&&__r__;if(!n&&l)return l(a,!0);if(s)return s(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var h=t[a]={exports:{}};e[a][0].call(h.exports,(function(t){var i;return o(e[a][1][t]||t)}),h,h.exports,r,e,t,i)}return t[a].exports}for(var s="function"==typeof __r__&&__r__,a=0;a<i.length;a++)o(i[a]);return o}return r}()({1:[function(__r__,e,t){var i=window.nkmjs[0].utils,s=i.PATH,a=i.LOG,n=window.nkmjs[0].env.ENV,l={exe:""};l[s.APP]="",l[s.HOME]="",l[s.APP_DATA]="",l[s.USER_DATA]="",l[s.TEMP]="",l[s.DESKTOP]="",l[s.DOCUMENTS]="",l[s.DOWNLOADS]="",l[s.MUSIC]="",l[s.PICTURES]="",l[s.VIDEOS]="",l[s.LOGS]="",l[s.STYLE]="style",a.toggle(!0),n.instance.Start({paths:l,argv:[],renderer:__r__(0),theme:"default",lang:"en",locales:[],isExtension:!0,manifestVersion:3})},{0:21,}],2:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n,l=function(e){_inherits(AppOptionsExplorer,e);var t=_createSuper(AppOptionsExplorer);function AppOptionsExplorer(){return _classCallCheck(this,AppOptionsExplorer),t.call(this)}return _createClass(AppOptionsExplorer,[{key:"_Style",value:function _Style(){return i.style.Extends({":host":{width:"350px"}},_get(_getPrototypeOf(AppOptionsExplorer.prototype),"_Style",this).call(this))}},{key:"_Render",value:function _Render(){_get(_getPrototypeOf(AppOptionsExplorer.prototype),"_Render",this).call(this),new a.manipulators.Text(s.El("p",{},this._header)).Set(s.tils.CamelSplit(this.constructor.name))}}]),AppOptionsExplorer}(i.uiworkspace.Explorer);e.exports=l},{}],3:[function(__r__,e,t){var i=window.nkmjs[0],s=__r__(1),a=i.utils,n=i.ui,l=i.uiworkspace,d=i.uilib,h="toggled",_="not-used",c=function(e){_inherits(FilterWidget,e);var t=_createSuper(FilterWidget);function FilterWidget(){return _classCallCheck(this,FilterWidget),t.call(this)}return _createClass(FilterWidget,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(FilterWidget.prototype),"_Init",this).call(this),this._flags.Add(this,h,_)}},{key:"_OnPaintChange",value:function _OnPaintChange(){_get(_getPrototypeOf(FilterWidget.prototype),"_OnPaintChange",this).call(this),this._isPainted?this.style.opacity=1:this.style.opacity=0}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{opacity:0,transition:"opacity 0.5s",height:"30px",position:"relative",display:"flex","flex-flow":"row nowrap","border-radius":"30px",padding:"4px","padding-left":"30px","padding-right":"10px","font-weight":"900"},":host(.toggled)":{background:"var(--fcol-10-0-i)"},".toggle":{flex:"1 1 auto"},":host(.not-used)":{opacity:"0.2 !important"}},_get(_getPrototypeOf(FilterWidget.prototype),"_Style",this).call(this))}},{key:"sourceEnum",set:function set(e){this._sourceEnum=e,this._toggle.label=e.id,this.toggle=e.flag}},{key:"toggle",set:function set(e){this._toggle.currentValue=e,this._sourceEnum.flag=e,this._flags.Set(h,e)}},{key:"_Render",value:function _Render(){_get(_getPrototypeOf(FilterWidget.prototype),"_Render",this).call(this),this._toggle=this.Add(d.inputs.Boolean,"toggle"),this._toggle.handler.Watch(n.inputs.SIGNAL.VALUE_SUBMITTED,this._OnToggleUserActivation,this)}},{key:"_OnToggleUserActivation",value:function _OnToggleUserActivation(e,t){this.toggle=t,i.env.APP.database._UpdateFilters()}}]),FilterWidget}(n.Widget);_defineProperty(c,"__usePaintCallback",!0),e.exports=c,n.Register("sgf-filter-widget",c)},{1:13,}],4:[function(__r__,e,t){var i=window.nkmjs[0],s=__r__(1),a=i.utils,n=i.ui,l=i.uiworkspace,d=i.uilib,h="no-profile",_=function(e){_inherits(FriendCard,e);var t=_createSuper(FriendCard);function FriendCard(){return _classCallCheck(this,FriendCard),t.call(this)}return _createClass(FriendCard,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(FriendCard.prototype),"_Init",this).call(this),this._Bind(this._OnToggleUserActivation),this._Bind(this._OnLogoLoadSuccess),this._Bind(this._OnLogoLoadError),this._flags.Add(this,h)}},{key:"_OnPaintChange",value:function _OnPaintChange(){_get(_getPrototypeOf(FriendCard.prototype),"_OnPaintChange",this).call(this),this._isPainted?this.style.opacity=1:this.style.opacity=0}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{opacity:0,transition:"opacity 0.5s",height:"55px","--header-size":"55px"},".header":{width:"var(--header-size)","min-height":"var(--header-size)","min-width":"var(--header-size)"},".body":{"padding-bottom":"0px"},".body .title":{"padding-right":"12px"},":host(.no-profile)":{},":host(.no-profile) .header":{opacity:.5},".btn-delete":{position:"absolute",top:"18px",right:"18px","--size":"var(--size-xs)"}},_get(_getPrototypeOf(FriendCard.prototype),"_Style",this).call(this))}},{key:"_Render",value:function _Render(){_get(_getPrototypeOf(FriendCard.prototype),"_Render",this).call(this),this._frame[n.IDS.TITLE].ellipsis=!0,this._deleteBtn=this.Add(d.buttons.Tool,"btn-delete"),this._deleteBtn.options={htitle:"Delete",icon:"close-small",trigger:{fn:this._Bind(this._DeleteUserEntry)},variant:n.FLAGS.MINIMAL},this.subtitle="hahah"}},{key:"_OnDataChanged",value:function _OnDataChanged(e){_get(_getPrototypeOf(FriendCard.prototype),"_OnDataChanged",this).call(this,e),this._data&&i.io.Read(this._data._avatarURL,{cl:i.io.resources.BlobResource},{success:this._OnLogoLoadSuccess,error:this._OnLogoLoadError,parallel:!0})}},{key:"_OnDataUpdated",value:function _OnDataUpdated(e){_get(_getPrototypeOf(FriendCard.prototype),"_OnDataUpdated",this).call(this,e),this.title=e._personaID,this.subtitle=null,this.label=null,e.existingUser?(this.flavor=i.ui.FLAGS.CTA,this._deleteBtn.visible=!0):(this.flavor=null,this._deleteBtn.visible=!1)}},{key:"_OnToggleUserActivation",value:function _OnToggleUserActivation(e,t){this._data.active=t}},{key:"Activate",value:function Activate(e){return!(!_get(_getPrototypeOf(FriendCard.prototype),"Activate",this).call(this,e)||this._data.existingUser||this._deleteBtn._pointer.isMouseOver)&&(this._data.existingUser=i.env.APP.database.GetUser(this._data._profileID64),!0)}},{key:"_DeleteUserEntry",value:function _DeleteUserEntry(){this._data.existingUser.Release()}},{key:"_OnLogoLoadSuccess",value:function _OnLogoLoadSuccess(e){this.media=e.objectURL}},{key:"_OnLogoLoadError",value:function _OnLogoLoadError(e){this.media=i.style.URLImgs("placeholder-dark.png")}}]),FriendCard}(d.cards.Media);_defineProperty(_,"__default_headerPlacement",n.FLAGS.LEFT),_defineProperty(_,"__usePaintCallback",!0),e.exports=_,n.Register("sgf-friendcard",_)},{1:13,}],5:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n=i.uiworkspace,l=i.uilib,d=__r__(1),h="dlc",_=function(e){_inherits(GameCard,e);var t=_createSuper(GameCard);function GameCard(){return _classCallCheck(this,GameCard),t.call(this)}return _createClass(GameCard,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(GameCard.prototype),"_Init",this).call(this),this._orientation.Set(a.FLAGS.VERTICAL),this._mediaPlacement.Set(a.FLAGS.TOP),this._flags.Add(this,h),this._logoLoaded=!1,this._Bind(this._OnLogoLoadSuccess),this._Bind(this._OnLogoLoadError)}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{cursor:"pointer",opacity:0,transition:"opacity 0.5s",width:"140px","max-width":"180px","--header-size":"225px"},":host(.dlc) .header::before":{position:"absolute",width:"100%",height:"30px","background-color":"rgba(255,255,255,0.5)",content:'"DLC"',"text-align":"center","padding-top":"10px",color:"black"}},_get(_getPrototypeOf(GameCard.prototype),"_Style",this).call(this))}},{key:"_Render",value:function _Render(){_get(_getPrototypeOf(GameCard.prototype),"_Render",this).call(this),this.media=i.style.URLImgs("placeholder-dark.png")}},{key:"_OnPaintChange",value:function _OnPaintChange(){this._CheckLogoStatus(),_get(_getPrototypeOf(GameCard.prototype),"_OnPaintChange",this).call(this),this._isPainted?this.style.opacity=1:this.style.opacity=0}},{key:"_OnDataChanged",value:function _OnDataChanged(e){this._logoLoaded=!1,_get(_getPrototypeOf(GameCard.prototype),"_OnDataChanged",this).call(this,e)}},{key:"_OnDataUpdated",value:function _OnDataUpdated(e){_get(_getPrototypeOf(GameCard.prototype),"_OnDataUpdated",this).call(this,e),this.htitle="Launch ".concat(e.name),this._toggle&&(this._toggle.currentValue=e.active),this.title=e.name;var t=null,s=null,a=null;switch(this._data.state){case d.STATE_NONE:a=i.common.FLAGS.WARNING;break;case d.STATE_LOADING:t="loading...",a=i.common.FLAGS.LOADING;break;case d.STATE_READY:break;case d.STATE_INVALID:a=i.common.FLAGS.ERROR}this.flavor=a,this.variant=s,this.subtitle=t;var n=e._childs.length;n>0&&(this.label="".concat(n,1==n?" DLC":" DLCs")),this._flags.Set(h,!!e._parentGame),this._CheckLogoStatus()}},{key:"_CheckLogoStatus",value:function _CheckLogoStatus(){!this._logoLoaded&&this._isPainted&&this._data&&this._data.state==d.STATE_READY&&(this._logoLoaded=!0,i.io.Read(this._data.logo,{cl:i.io.resources.BlobResource},{success:this._OnLogoLoadSuccess,error:this._OnLogoLoadError,parallel:!0}))}},{key:"_OnLogoLoadSuccess",value:function _OnLogoLoadSuccess(e){this.media=e.objectURL}},{key:"_OnLogoLoadError",value:function _OnLogoLoadError(e){this.media=i.style.URLImgs("placeholder-dark.png")}},{key:"Activate",value:function Activate(e){return!!_get(_getPrototypeOf(GameCard.prototype),"Activate",this).call(this,e)&&(this._Launch(),!0)}},{key:"_Launch",value:function _Launch(){var e="steam://run/".concat(this._data.appid,"/");window.open(e)}}]),GameCard}(l.cards.Media);_defineProperty(_,"__usePaintCallback",!0),e.exports=_,a.Register("sgf-gamecard",_)},{1:13,}],6:[function(__r__,e,t){e.exports={UserCard:__r__(2),FriendCard:__r__(3),GameCard:__r__(4),InfoCard:__r__(5),UserInputField:__r__(6),FilterWidget:__r__(7)}},{7:3,3:4,4:5,5:7,2:8,6:9}],7:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n=i.uiworkspace,l=i.uilib,d=__r__(8),h=function(e){_inherits(InfoCard,e);var t=_createSuper(InfoCard);function InfoCard(){return _classCallCheck(this,InfoCard),t.call(this)}return _createClass(InfoCard,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(InfoCard.prototype),"_Init",this).call(this),i.env.APP.database.Watch(d.INFOS_UPDATED,this._OnInfosUpdated,this)}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{}},_get(_getPrototypeOf(InfoCard.prototype),"_Style",this).call(this))}},{key:"_Render",value:function _Render(){_get(_getPrototypeOf(InfoCard.prototype),"_Render",this).call(this),this.label="<i>Certain things such as films, apps, and other outlier products are omitted.</i>"}},{key:"_OnPaintChange",value:function _OnPaintChange(){_get(_getPrototypeOf(InfoCard.prototype),"_OnPaintChange",this).call(this),this._isPainted?this.style.opacity=1:this.style.opacity=0}},{key:"_OnInfosUpdated",value:function _OnInfosUpdated(){var e=i.env.APP.database;e._filterShowAll.flag?this._UpdateCardShowAll():0==e._userReadyList.count?this._UpdateCardNoUsers():0==e._filteredCount?this._UpdateCardNoOverlap():this._UpdateCardsRegular()}},{key:"_UpdateCardNoUsers",value:function _UpdateCardNoUsers(){this.title="Shared games !",this.subtitle="This is where they will show once you get some libraries loaded.",this.variant=a.FLAGS.FRAME,this.flavor=a.FLAGS.CTA,this.icon="dots"}},{key:"_UpdateCardNoOverlap",value:function _UpdateCardNoOverlap(){this.title="Oops",this.subtitle="The current settings (active users & active filters) produces no overlap.",this.variant=a.FLAGS.FRAME,this.flavor=i.common.FLAGS.ERROR,this.icon="hidden"}},{key:"_UpdateCardShowAll",value:function _UpdateCardShowAll(){this.title="That's ".concat(i.env.APP.database._filteredCount," games."),this.subtitle="Currently showing the games of everyone.",this.variant=a.FLAGS.FRAME,this.flavor=a.FLAGS.CTA,this.icon="view-grid"}},{key:"_UpdateCardsRegular",value:function _UpdateCardsRegular(){this.title="That's ".concat(i.env.APP.database._filteredCount," games."),this.subtitle="Currently showing the result of active users + active filters",this.variant=a.FLAGS.FRAME,this.flavor=null,this.icon="visible"}}]),InfoCard}(l.cards.Icon);_defineProperty(h,"__usePaintCallback",!0),e.exports=h,a.Register("sgf-infocard",h)},{8:14,}],8:[function(__r__,e,t){var i=window.nkmjs[0],s=__r__(1),a=i.utils,n=i.ui,l=i.uiworkspace,d=i.uilib,h="no-profile",_=function(e){_inherits(UserCard,e);var t=_createSuper(UserCard);function UserCard(){return _classCallCheck(this,UserCard),t.call(this)}return _createClass(UserCard,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(UserCard.prototype),"_Init",this).call(this),this._Bind(this._OnToggleUserActivation),this._Bind(this._OnLogoLoadSuccess),this._Bind(this._OnLogoLoadError),this._flags.Add(this,h),this._flags.Add(this,"inactive")}},{key:"_OnPaintChange",value:function _OnPaintChange(){_get(_getPrototypeOf(UserCard.prototype),"_OnPaintChange",this).call(this),this._isPainted?this.style.setProperty("--op","var(--currentOpacity)"):this.style.setProperty("--op",0)}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{"--currentOpacity":1,"--op":0,opacity:"var(--op)",transition:"opacity 0.5s",height:"115px","--header-size":"115px"},":host(.inactive)":{"--currentOpacity":"0.5"},".header":{"min-height":"80px"},".body .title":{"padding-right":"12px"},":host(.no-profile)":{},":host(.no-profile) .header":{"--currentOpacity":"0.3"},".btn-delete":{position:"absolute",top:"18px",right:"18px","--size":"var(--size-xs)"}},_get(_getPrototypeOf(UserCard.prototype),"_Style",this).call(this))}},{key:"_Render",value:function _Render(){_get(_getPrototypeOf(UserCard.prototype),"_Render",this).call(this),this._frame[n.IDS.TITLE].ellipsis=!0,this._deleteBtn=this.Add(d.buttons.Tool,"btn-delete"),this._deleteBtn.options={htitle:"Delete",icon:"close-small",trigger:{fn:this._Bind(this._DeleteUserEntry)},variant:n.FLAGS.MINIMAL},this.actions=[{htitle:"Browser friendlist",label:"Friendlist",trigger:{fn:this._Bind(this._OpenFriendlist)},variant:n.FLAGS.FRAME},{cl:d.inputs.Boolean,inputWatchers:[{signal:n.inputs.SIGNAL.VALUE_SUBMITTED,fn:this._OnToggleUserActivation}],member:{owner:this,id:"_toggle"},currentValue:!0}],this._toolbar.size=n.FLAGS.SIZE_XS}},{key:"_OnDataChanged",value:function _OnDataChanged(e){_get(_getPrototypeOf(UserCard.prototype),"_OnDataChanged",this).call(this,e),this._data&&i.io.Read(this._data._avatarURL,{cl:i.io.resources.BlobResource},{success:this._OnLogoLoadSuccess,error:this._OnLogoLoadError,parallel:!0})}},{key:"_OnDataUpdated",value:function _OnDataUpdated(e){_get(_getPrototypeOf(UserCard.prototype),"_OnDataUpdated",this).call(this,e),this._toggle&&(this._toggle.currentValue=e.active),this._flags.Set("inactive",!e.active),this.media=e._avatarURL||i.style.URLImgs("placeholder-dark.png"),this.title=e._personaID;var t="...",a=!1,n=null,l=null,d=!0;switch(this._data.state){case s.STATE_NONE:l=i.common.FLAGS.WARNING,d=!1;break;case s.STATE_LOADING:t="loading...",l=i.common.FLAGS.LOADING,d=!1;break;case s.STATE_READY:"private"==e._privacy?(t="Profile is private",l=i.common.FLAGS.WARNING):t="".concat(e.gamesCount," products in library");break;case s.STATE_INVALID:"private"==e._privacy?(t="Profile is private",l=i.common.FLAGS.WARNING):(t="Profile could not be loaded.",l=i.common.FLAGS.ERROR,d=!1,a=!0)}this._toolbar.visible=d,this.flavor=l,this.variant=n,this._flags.Set(h,a),this.subtitle=t}},{key:"_OnToggleUserActivation",value:function _OnToggleUserActivation(e,t){this._data.active=t}},{key:"_OpenFriendlist",value:function _OpenFriendlist(){i.env.APP._RequestFriendList(this._data)}},{key:"_DeleteUserEntry",value:function _DeleteUserEntry(){this._data.Release()}},{key:"_OnLogoLoadSuccess",value:function _OnLogoLoadSuccess(e){this.media=e.objectURL}},{key:"_OnLogoLoadError",value:function _OnLogoLoadError(e){this.media=i.style.URLImgs("placeholder-dark.png")}}]),UserCard}(d.cards.Media);_defineProperty(_,"__default_headerPlacement",n.FLAGS.LEFT),_defineProperty(_,"__usePaintCallback",!0),e.exports=_,n.Register("sgf-usercard",_)},{1:13,}],9:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n=i.uiworkspace,l=i.uilib,d=__r__(9),h=__r__(8),_=__r__(1),c=function(e){_inherits(UserInputField,e);var t=_createSuper(UserInputField);function UserInputField(){return _classCallCheck(this,UserInputField),t.call(this)}return _createClass(UserInputField,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(UserInputField.prototype),"_Init",this).call(this)}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{display:"flex","flex-flow":"row nowrap"},".field-id":{flex:"1 1 auto"},".btn-add":{flex:"0 0 auto"}},_get(_getPrototypeOf(UserInputField.prototype),"_Style",this).call(this))}},{key:"_Render",value:function _Render(){var e=this,t;_get(_getPrototypeOf(UserInputField.prototype),"_Render",this).call(this),this._inputField=this.Add(l.inputs.Text,"field-id"),this._inputField.placeholderValue="Profile name, url, ...",this._inputField.handler.Watch(a.inputs.SIGNAL.VALUE_SUBMITTED,this._OnInputSubmit,this),this._submitBtn=this.Add(l.buttons.Tool,"btn-add"),this._submitBtn.options=(_defineProperty(t={},a.IDS.FLAVOR,a.FLAGS.CTA),_defineProperty(t,a.IDS.ICON,"plus"),_defineProperty(t,"trigger",{fn:function fn(){e._inputField.handler.SubmitValue()},thisArg:this}),t)}},{key:"_OnInputSubmit",value:function _OnInputSubmit(e,t){var s=this._inputField.currentValue;try{if(this._ReadJSONList(s))return void(this._inputField.currentValue="");if(""==s)return;var a=s,n;if(s.includes(".com/profiles"))(n=(a=s.split(".com/profiles/")[1]).split("/")).length>1&&(a=n[0]);else if(s.includes(".com/id")){var n;(n=(a=s.split(".com/id/")[1]).split("/")).length>1&&(a=n[0])}if(""==a||a.length>64)return;i.env.APP.database.GetUser(a),this._inputField.currentValue=""}catch(e){console.log(e),this._inputField.currentValue=""}}},{key:"_ReadJSONList",value:function _ReadJSONList(e){try{var t=JSON.parse(e);if(!Array.isArray(t))return!1;for(var s=0,a=t.length;s<a;s++)""!=t[s].id&&i.env.APP.database.GetUser(t[s].id,t[s].active);return!0}catch(e){return!1}}},{key:"_InitSearch",value:function _InitSearch(){this._submitCallback.call()}}]),UserInputField}(a.DisplayObjectContainer);e.exports=c,a.Register("sgf-userinputfield",c)},{9:6,1:13,8:14,}],10:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.collections,n=__r__(10),l=__r__(11),d=__r__(12),h=__r__(13),_="userlist",c="filterlist",u=function(e){_inherits(Database,e);var t=_createSuper(Database);function Database(){return _classCallCheck(this,Database),t.call(this)}return _createClass(Database,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(Database.prototype),"_Init",this).call(this),this._gameMap=new a.Dictionary,this._applist=new Array,this._flagMap=new a.Dictionary,this._userMap=new a.Dictionary,this._currentOverlap=new Array,this._filteredCount=0,this._userReadyList=new i.collections.List,this._userStatuses=d.STATE_NONE,this._delayedUpdate=new i.common.time.DelayedCall(this._Bind(this._UpdateInfos)),this._delayedComputeOverlap=new i.common.time.DelayedCall(this._Bind(this._ComputeLibrariesOverlap)),this._enums=[],this._enums.push({key:"21",id:"dlc",flag:!1}),this._enums.push({key:"2",id:"single_player",flag:!1}),this._enums.push({key:"49",id:"pvp",flag:!0}),this._enums.push({key:"9",id:"coop",flag:!0}),this._enums.push({key:"20",id:"MMO",flag:!1}),this._enums.push({key:"36",id:"Online PvP",flag:!0}),this._enums.push({key:"38",id:"Online Coop",flag:!0}),this._enums.push({key:"47",id:"LAN PvP",flag:!1}),this._enums.push({key:"48",id:"LAN Coop",flag:!1}),this._enums.push({key:"37",id:"Split screen PvP",flag:!1}),this._enums.push({key:"39",id:"Split screen Coop",flag:!1}),this._enums.push({key:"44",id:"Remote play together",flag:!1}),this._enums.push({key:"-1",id:"Show all",flag:!1}),this._filterShowAll={id:"Show all",flag:!1},this._filters=new Array;var e=i.env.prefs.Get(c,this._filters);e==this._filters?this._UpdateFilters():this._LoadStoredFilterList(e)}},{key:"_LoadStoredFilterList",value:function _LoadStoredFilterList(e){for(var t=0,i=this._enums.length;t<i;t++){var s=this._enums[t];s.flag=e.includes(s.key)}this._UpdateFilters()}},{key:"GetGame",value:function GetGame(e){var t=null;return this._gameMap.Contains(e)?t=this._gameMap.Get(e):((t=new n).appid=e,t._db=this,t.Watch(h.STATE_CHANGED,this._OnGameStateChanged,this),this._gameMap.Set(e,t),t.RequestLoad()),t}},{key:"_OnGameUpdated",value:function _OnGameUpdated(e){this._Broadcast(h.GAME_UPDATED,e),this._delayedUpdate.Schedule()}},{key:"_OnGameStateChanged",value:function _OnGameStateChanged(e,t){t==d.STATE_READY&&(this._applist.includes(e)||(this._applist.push(e),this._Broadcast(h.GAME_ADDED,e),e.Watch(i.common.SIGNAL.UPDATED,this._OnGameUpdated,this),this._delayedComputeOverlap.Schedule()))}},{key:"FindUser",value:function FindUser(e){if(this._userMap.Contains(e))return this._userMap.Get(e);var t=this._userMap.keys;e=e.toLowerCase();for(var i=0;i<t.length;i++){var s=this._userMap.Get(t[i]);if(s._personaID.toLowerCase()==e)return s}return null}},{key:"GetUser",value:function GetUser(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=this.FindUser(e);return s||((s=new l).Watch(i.common.SIGNAL.RELEASED,this._OnUserReleased,this),s.userid=e,s.active=t,s._db=this,this._userMap.Set(e,s),this._Broadcast(h.USER_ADDED,s),s.Watch(i.common.SIGNAL.UPDATED,this._OnUserUpdate,this),s.RequestLoad()),s}},{key:"_UpdateUserID",value:function _UpdateUserID(e,t){var i;this._userMap.Get(t)==e&&(this._userMap.Remove(t),this._userMap.Set(e.userid,e))}},{key:"_OnUserReleased",value:function _OnUserReleased(e){this._userMap.Remove(e.userid),this._Broadcast(h.USER_REMOVED,e),this._userReadyList.Contains(e)&&(this._userReadyList.Remove(e),this._delayedComputeOverlap.Schedule()),i.env.prefs.Set(_,this._GetUserJSONData()),this._delayedUpdate.Schedule()}},{key:"_OnUserUpdate",value:function _OnUserUpdate(e){if(e.state==d.STATE_READY){var t=!1;e.gamesCount>0&&e.active?this._userReadyList.Contains(e)||(this._userReadyList.Add(e),t=!0):this._userReadyList.Contains(e)&&(this._userReadyList.Remove(e),t=!0),t&&this._delayedComputeOverlap.Schedule(),i.env.prefs.Set(_,this._GetUserJSONData())}}},{key:"_GetUserJSONData",value:function _GetUserJSONData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t;e||(e=this._userMap.keys);for(var i=[],s=0,a=e.length;s<a;s++)""!=(t=this._userMap.Get(e[s])).profileID64&&i.push({id:t.profileID64,active:t.active});return i}},{key:"_ComputeLibrariesOverlap",value:function _ComputeLibrariesOverlap(){this._currentOverlap.length=0;for(var e=0;e<this._applist.length;e++){for(var t=this._applist[e],i=t.appid,s=!0,a=0;a<this._userReadyList.count;a++)this._userReadyList.At(a)._gameList.Contains(i)||(s=!1);s?this._currentOverlap.push(t):t.shouldShow=!1}this._delayedUpdate.Schedule()}},{key:"_UpdateFilters",value:function _UpdateFilters(){this._filters.length=0,this._filterShowAll.flag||this._ComputeLibrariesOverlap();for(var e=0,t=this._enums.length;e<t;e++){var s=this._enums[e];s.flag&&this._filters.push(s.key)}i.env.prefs.Delete(c),i.env.prefs.Set(c,this._filters),this._Broadcast(h.FILTERS_UPDATED,this),this._delayedUpdate.Schedule()}},{key:"_UpdateInfos",value:function _UpdateInfos(){var e;if(this._filteredCount=0,this._filterShowAll.flag){for(var t=0;t<this._applist.length;t++)(e=this._applist[t]).HasAnyActiveUsers()?(this._filteredCount++,e.shouldShow=!0):e.shouldShow=!1;this._Broadcast(h.INFOS_UPDATED,this)}else if(0!=this._currentOverlap.length){for(var i=0,s=this._applist.length;i<s;i++)this._applist[i].shouldShow=!1;for(var a=0,n=this._currentOverlap.length;a<n;a++){var l=(e=this._currentOverlap[a]).HasFlags(this._filters);e.shouldShow=l,l&&this._filteredCount++}this._Broadcast(h.INFOS_UPDATED,this)}else this._Broadcast(h.INFOS_UPDATED,this)}},{key:"_CleanUp",value:function _CleanUp(){_get(_getPrototypeOf(Database.prototype),"_CleanUp",this).call(this)}}]),Database}(i.common.pool.DisposableObjectEx);e.exports=u},{10:12,12:13,13:14,11:15,}],11:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.io,n=__r__(12),l=function(e){_inherits(FriendData,e);var t=_createSuper(FriendData);function FriendData(){return _classCallCheck(this,FriendData),t.call(this)}return _createClass(FriendData,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(FriendData.prototype),"_Init",this).call(this),this._existingUser=null,this._profileID64="",this._personaID="",this._avatarURL="",this._privacy=""}},{key:"existingUser",get:function get(){return this._existingUser},set:function set(e){if(this._existingUser!=e){var t=this._existingUser;t&&t.Unwatch(i.common.SIGNAL.RELEASED,this._OnExistingReleased,this),this._existingUser=e,this._existingUser&&this._existingUser.Watch(i.common.SIGNAL.RELEASED,this._OnExistingReleased,this),this.CommitUpdate()}}},{key:"_OnExistingReleased",value:function _OnExistingReleased(){this.existingUser=null}},{key:"_CleanUp",value:function _CleanUp(){this.existingUser=null,this._profileID64="",this._personaID="",this._avatarURL="",this._privacy="",_get(_getPrototypeOf(FriendData.prototype),"_CleanUp",this).call(this)}}]),FriendData}(i.data.DataBlock);e.exports=l},{12:13,}],12:[function(__r__,e,t){var i=window.nkmjs[0],s,a=function(e){_inherits(GameData,e);var t=_createSuper(GameData);function GameData(){return _classCallCheck(this,GameData),t.call(this)}return _createClass(GameData,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(GameData.prototype),"_Init",this).call(this),this._rscType=i.io.resources.JSONResource,this._appid="",this._parentGame=null,this._flags=null,this._tags=null,this._users=new Array,this._childs=new Array,this._name="",this._logo="",this._shouldShow=!1}},{key:"shouldShow",get:function get(){return this._shouldShow},set:function set(e){this._shouldShow=e}},{key:"usercount",get:function get(){return this._users.length}},{key:"appid",get:function get(){return this._appid},set:function set(e){this._appid=e,this._name="".concat(e),this._logo="https://steamcdn-a.akamaihd.net/steam/apps/".concat(e,"/library_600x900.jpg"),this._dataPath="https://nebukam.github.io/steam/app/".concat(e,"/infos.json")}},{key:"name",get:function get(){return this._name},set:function set(e){this._name!=e&&(this._name=e,this.CommitUpdate())}},{key:"logo",get:function get(){return this._logo},set:function set(e){this._logo!=e&&(this._logo=e,this.CommitUpdate())}},{key:"HasAnyActiveUsers",value:function HasAnyActiveUsers(){for(var e=0;e<this._users.length;e++)if(this._users[e].active)return!0;return!1}},{key:"HasFlags",value:function HasFlags(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.isReady)return!1;if(!e.includes("21")&&this._flags.includes("21"))return!1;for(var i=null,s=e.length,a=0,n=0,l=s;n<l;n++)this._flags.includes(e[n])&&a++;return t?a>0:a==s}},{key:"HasTags",value:function HasTags(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.isReady)return!1;for(var i=null,s=e.length,a=0,n=0,l=s;n<l;n++){i=e[n];for(var d=0,h=this._tags.length;d<h;d++)this._flags[n]==i&&a++}return t?a>0:a==s}},{key:"_OnLoadRequestSuccess",value:function _OnLoadRequestSuccess(e){this._flags=e.content.flags,this._tags=e.content.tags,this._name=e.content.name;var t=e.content.parentappid;""!=t&&(this._flags.includes("21")||this._flags.push("21"),this._parentGame=i.env.APP.database.GetGame(t),this._parentGame.AddChild(this)),_get(_getPrototypeOf(GameData.prototype),"_OnLoadRequestSuccess",this).call(this,e)}},{key:"AddChild",value:function AddChild(e){this._childs.includes(e)||(this._childs.push(e),e._flags&&!e._flags.includes("21")&&(e._flags.push("21"),e.CommitUpdate()),this.CommitUpdate())}},{key:"AddUser",value:function AddUser(e){var t;-1==this._users.indexOf(e)&&this._users.push(e)}},{key:"RemoveUser",value:function RemoveUser(e){var t=this._users.indexOf(e);-1!=t&&this._users.splice(t,1)}},{key:"_CleanUp",value:function _CleanUp(){_get(_getPrototypeOf(GameData.prototype),"_CleanUp",this).call(this)}}]),GameData}(__r__(12));e.exports=a},{12:13,}],13:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.io,n=__r__(13),l=function(e){_inherits(RemoteDataBlock,e);var t=_createSuper(RemoteDataBlock);function RemoteDataBlock(){return _classCallCheck(this,RemoteDataBlock),t.call(this)}return _createClass(RemoteDataBlock,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(RemoteDataBlock.prototype),"_Init",this).call(this),this._loadPriority=!1,this._loadParallel=!0,this._rscType=a.resources.TextResource,this._db=null,this._state=RemoteDataBlock.STATE_NONE,this._dataPath="",this._Bind(this._OnLoadRequestSuccess),this._Bind(this._OnLoadRequestError),this._Bind(this._OnLoadRequestComplete)}},{key:"state",get:function get(){return this._state},set:function set(e){if(e!=this._state){var t=this._state;this._state=e,this._Broadcast(n.STATE_CHANGED,this,e,t),this.CommitUpdate()}}},{key:"isReady",get:function get(){return this._state==RemoteDataBlock.STATE_READY}},{key:"RequestLoad",value:function RequestLoad(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||this._state==RemoteDataBlock.STATE_NONE)&&(this.state=RemoteDataBlock.STATE_LOADING,a.Read(this._dataPath,{cl:this._rscType},{success:this._OnLoadRequestSuccess,error:this._OnLoadRequestError,any:this._OnLoadRequestComplete,important:this._loadPriority,parallel:this._loadParallel}))}},{key:"_OnLoadRequestSuccess",value:function _OnLoadRequestSuccess(e){this.state=RemoteDataBlock.STATE_READY}},{key:"_OnLoadRequestError",value:function _OnLoadRequestError(e){console.error(e),e.response&&429==e.response.status&&i.env.APP._429(),this.state=RemoteDataBlock.STATE_INVALID}},{key:"_OnLoadRequestComplete",value:function _OnLoadRequestComplete(){}},{key:"_CleanUp",value:function _CleanUp(){this._state=RemoteDataBlock.STATE_NONE,this._dataPath="",_get(_getPrototypeOf(RemoteDataBlock.prototype),"_CleanUp",this).call(this)}}]),RemoteDataBlock}(i.data.DataBlock);_defineProperty(l,"STATE_NONE","state-none"),_defineProperty(l,"STATE_LOADING","state-loading"),_defineProperty(l,"STATE_READY","state-ready"),_defineProperty(l,"STATE_INVALID","state-invalid"),e.exports=l},{13:14,}],14:[function(__r__,e,t){var i=function SIGNAL(){_classCallCheck(this,SIGNAL)};_defineProperty(i,"STATE_CHANGED",Symbol("state-changed")),_defineProperty(i,"USER_ADDED",Symbol("user-added")),_defineProperty(i,"USER_REMOVED",Symbol("user-removed")),_defineProperty(i,"USER_UPDATED",Symbol("user-updated")),_defineProperty(i,"GAME_ADDED",Symbol("game-added")),_defineProperty(i,"GAME_REMOVED",Symbol("game-removed")),_defineProperty(i,"GAME_UPDATED",Symbol("game-updated")),_defineProperty(i,"INFOS_UPDATED",Symbol("infos-updated")),_defineProperty(i,"FILTERS_UPDATED",Symbol("filters-updated")),e.exports=i},{}],15:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.io,n=__r__(12),l=function(e){_inherits(UserData,e);var t=_createSuper(UserData);function UserData(){return _classCallCheck(this,UserData),t.call(this)}return _createClass(UserData,[{key:"_isID64",value:function _isID64(e){return!!e&&!(!/^\d+$/.test(e)||17!=e.length);var t}},{key:"_Init",value:function _Init(){_get(_getPrototypeOf(UserData.prototype),"_Init",this).call(this),this._loadPriority=!0,this._loadParallel=!0,this._triedWithPersona=!1,this._userID="",this._active=!0,this._profileID64="",this._personaID="",this._avatarURL="",this._privacy="",this._gameList=new i.collections.Dictionary,this._xmlparser=new DOMParser,this._Bind(this._OnProfileByIDRequestSuccess),this._Bind(this._OnProfileByIDRequestError),this._Bind(this._OnXMLProfileLoaded),this._Bind(this._OnXMLProfileError)}},{key:"gamesLoaded",get:function get(){return this._gamesLoaded}},{key:"gamesCount",get:function get(){return this._gameList.count}},{key:"userid",get:function get(){return this._userID},set:function set(e){if(this._userID!=e){var t=this._userID;this._userID=e,this._db&&this._db._UpdateUserID(this,t)}}},{key:"active",get:function get(){return this._active},set:function set(e){this._active!=e&&(this._active=e,this.CommitUpdate())}},{key:"profileID64",get:function get(){return this._profileID64},set:function set(e){this._profileID64!=e&&this._isID64(e)&&(this._profileID64=e,this.userid=e,this._dataPath="https://steamcommunity.com/profiles/".concat(e,"/games/?tab=all"))}},{key:"RequestLoad",value:function RequestLoad(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||this._state==n.STATE_NONE)&&(this._isID64(this.userid)?(this.profileID64=this.userid,this._LoadProfile()):(this._personaID=this.userid,this.state=n.STATE_LOADING,a.Read("https://steamcommunity.com/id/".concat(this.userid,"?xml=1"),{cl:a.resources.TextResource},{success:this._OnProfileByIDRequestSuccess,error:this._OnProfileByIDRequestError,important:!0,parallel:!0})))}},{key:"_OnProfileByIDRequestSuccess",value:function _OnProfileByIDRequestSuccess(e){try{var t=this._xmlparser.parseFromString(e.content,"text/xml");this.profileID64=t.getElementsByTagName("steamID64")[0].childNodes[0].nodeValue}catch(e){return void this._OnProfileByIDRequestError(e)}this._OnXMLProfileLoaded(e)}},{key:"_OnProfileByIDRequestError",value:function _OnProfileByIDRequestError(e){console.error("Could not load profile details",e),this.state=n.STATE_INVALID}},{key:"_LoadProfile",value:function _LoadProfile(){a.Read("https://steamcommunity.com/profiles/".concat(this._profileID64,"?xml=1"),{cl:a.resources.TextResource},{success:this._OnXMLProfileLoaded,error:this._OnXMLProfileError,important:!0,parallel:!0})}},{key:"_OnXMLProfileLoaded",value:function _OnXMLProfileLoaded(e){var t=this._xmlparser.parseFromString(e.content,"text/xml");this.profileID64=t.getElementsByTagName("steamID64")[0].childNodes[0].nodeValue,this._personaID=t.getElementsByTagName("steamID")[0].childNodes[0].nodeValue,this._avatarURL=t.getElementsByTagName("avatarFull")[0].childNodes[0].nodeValue,this._privacy=t.getElementsByTagName("privacyState")[0].childNodes[0].nodeValue,this._limitedAccount=t.getElementsByTagName("isLimitedAccount")[0].childNodes[0].nodeValue;var s="users._".concat(this.userid,".gamelist"),a=i.env.prefs.Get(s,[]);a&&a.length>0?(this._ProcessGameList(a),this.CommitUpdate(),_get(_getPrototypeOf(UserData.prototype),"_OnLoadRequestSuccess",this).call(this,e)):(this.CommitUpdate(),_get(_getPrototypeOf(UserData.prototype),"RequestLoad",this).call(this,!0))}},{key:"_OnXMLProfileError",value:function _OnXMLProfileError(e){console.error(e),this.state=n.STATE_INVALID}},{key:"_OnLoadRequestSuccess",value:function _OnLoadRequestSuccess(e){var t=[];try{var s=e.content.split("var rgGames = ");s.splice(0,1),s=s[0].split("];")[0].trim();try{t=JSON.parse("".concat(s,"]"))}catch(e){console.log("".concat(s,"]"))}for(var a=0;a<t.length;a++)t[a]=t[a].appid}catch(e){return void this._OnLoadRequestError(e)}var n="users._".concat(this.userid,".gamelist");i.env.prefs.Set(n,t),this._ProcessGameList(t),_get(_getPrototypeOf(UserData.prototype),"_OnLoadRequestSuccess",this).call(this,e)}},{key:"_OnLoadRequestError",value:function _OnLoadRequestError(e){if(!this._triedWithPersona)return this._triedWithPersona=!0,this._dataPath="https://steamcommunity.com/id/".concat(this._personaID,"/games/?tab=all"),void _get(_getPrototypeOf(UserData.prototype),"RequestLoad",this).call(this,!0);_get(_getPrototypeOf(UserData.prototype),"_OnLoadRequestError",this).call(this,e)}},{key:"_ProcessGameList",value:function _ProcessGameList(e){for(var t=0,i=e.length;t<i;t++){var s=e[t],a=this._db.GetGame(s);a.AddUser(this),this._gameList.Set(s,a)}0==e.length&&(this._privacy="private")}},{key:"_ClearGameList",value:function _ClearGameList(){for(var e=this._gameList.keys,t=0,i=e.length;t<i;t++)this._gameList.Get(e[t]).RemoveUser(this)}},{key:"_CleanUp",value:function _CleanUp(){this._userID="",this._profileID64="",this._personaID="",this._avatarURL="",this._privacy="",this._ClearGameList(),this._triedWithPersona=!1,this._gameList.Clear(),_get(_getPrototypeOf(UserData.prototype),"_CleanUp",this).call(this)}}]),UserData}(n);e.exports=l},{12:13,}],16:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n=i.uiworkspace,l=i.uilib,d=__r__(9),h=__r__(8),_=function(e){_inherits(GameFiltersExplorer,e);var t=_createSuper(GameFiltersExplorer);function GameFiltersExplorer(){return _classCallCheck(this,GameFiltersExplorer),t.call(this)}return _createClass(GameFiltersExplorer,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(GameFiltersExplorer.prototype),"_Init",this).call(this),this._filtermap=new i.collections.Dictionary,i.env.features.Watch(i.env.SIGNAL.DISPLAY_TYPE_CHANGED,this._OnDisplayTypeChanged,this),i.env.APP.database.Watch(h.INFOS_UPDATED,this._OnInfosUpdated,this)}},{key:"_OnDisplayTypeChanged",value:function _OnDisplayTypeChanged(e,t){e==i.env.ENV_DISPLAY.MOBILE?this.style.setProperty("--panelWidth","100%-50px"):this.style.removeProperty("--panelWidth")}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{"--panelWidth":"325px",width:"var(--panelWidth)"},".header, .footer":{padding:"10px"},".body":{padding:"0px 8px 0px 4px","webkit-box-shadow":"none","box-shadow":"none"},".filter-item":{"margin-bottom":"4px"},".show-all":{"margin-bottom":"20px"}},_get(_getPrototypeOf(GameFiltersExplorer.prototype),"_Style",this).call(this))}},{key:"_Render",value:function _Render(){var e;_get(_getPrototypeOf(GameFiltersExplorer.prototype),"_Render",this).call(this),this.Add(d.FilterWidget,"filter-item show-all",this._body).sourceEnum=i.env.APP.database._filterShowAll;for(var t=i.env.APP.database._enums,s=0;s<t.length;s++){var a=t[s],n=this.Add(d.FilterWidget,"filter-item",this._body);n.sourceEnum=a,this._filtermap.Set(a,n)}}},{key:"_OnInfosUpdated",value:function _OnInfosUpdated(){if(i.env.APP.database._filterShowAll.flag)for(var e=this._filtermap.keys,t=0;t<e.length;t++)this._filtermap.Get(e[t])._flags.Set("not-used",!0);else for(var s=this._filtermap.keys,t=0;t<s.length;t++)this._filtermap.Get(s[t])._flags.Set("not-used",!1)}}]),GameFiltersExplorer}(n.Explorer);e.exports=_,a.Register("sgf-gamefilters",_)},{9:6,8:14,}],17:[function(__r__,e,t){e.exports={UserList:__r__(14),GameFilters:__r__(15)}},{15:16,14:18}],18:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n=i.uiworkspace,l=i.uilib,d=__r__(9),h=__r__(8),_=__r__(1),c=function(e){_inherits(UserListExplorer,e);var t=_createSuper(UserListExplorer);function UserListExplorer(){return _classCallCheck(this,UserListExplorer),t.call(this)}return _createClass(UserListExplorer,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(UserListExplorer.prototype),"_Init",this).call(this),this._usermap=new i.collections.Dictionary,i.env.APP.database.Watch(h.USER_ADDED,this._OnUserAdded,this),i.env.APP.database.Watch(h.USER_REMOVED,this._OnUserRemoved,this),i.env.APP.database.Watch(h.USER_UPDATED,this._OnUserUpdated,this),i.env.APP.database.Watch(h.INFOS_UPDATED,this._OnInfosUpdated,this),i.env.features.Watch(i.env.SIGNAL.DISPLAY_TYPE_CHANGED,this._OnDisplayTypeChanged,this)}},{key:"_OnDisplayTypeChanged",value:function _OnDisplayTypeChanged(e,t){e==i.env.ENV_DISPLAY.MOBILE?this.style.setProperty("--panelWidth","100%-50px"):this.style.removeProperty("--panelWidth")}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{"--panelWidth":"325px",width:"var(--panelWidth)"},".header, .footer":{padding:"10px"},".body":{padding:"0px 8px 0px 4px","webkit-box-shadow":"none","box-shadow":"none"},".user-input-field":{},".user-card":{"margin-bottom":"4px",width:"100%"},".info-card":{flex:"1 1 auto",margin:"4px","margin-top":"0px","--size":"100%-8px"}},_get(_getPrototypeOf(UserListExplorer.prototype),"_Style",this).call(this))}},{key:"_Render",value:function _Render(){var e,t;_get(_getPrototypeOf(UserListExplorer.prototype),"_Render",this).call(this),this.Add(d.UserInputField,"user-input-field",this._header),this._copyBtn=this.Add(l.buttons.Button,"btn-copy",this._footer),this._copyBtn.options=(_defineProperty(e={},a.IDS.LABEL,"Copy to clipboard"),_defineProperty(e,"trigger",{fn:this._Bind(this._CopyUsersToClipboard)}),e),this._infoCard=this.Add(i.uilib.cards.Icon,"info-card",this._body),this._infoCard._optionsHandler.Process(this._infoCard,(_defineProperty(t={},"header-placement",i.ui.FLAGS.TOP),_defineProperty(t,"title","Add friends !"),_defineProperty(t,"subtitle","<b>Just type their nickname and click [+] !</b></br></br>If that doesn't work, try with their unique profile ID; it's a 17-long number you can find when visiting your friend profile page on the Steam community website.</br>You can also paste the whole url."),_defineProperty(t,"label","</br>Note that if you are loggued to the steam community website while using the Steam Game Finder, you should be able to load your friends profile even if private."),_defineProperty(t,"variant",a.FLAGS.MINIMAL),_defineProperty(t,"flavor",a.FLAGS.CTA),_defineProperty(t,"icon","up"),t))}},{key:"_OnUserAdded",value:function _OnUserAdded(e){var t=this._usermap.Get(e);t||((t=this.Add(d.UserCard,"user-card")).data=e,t._friendsCallback=this._friendsCallback,this._usermap.Set(e,t),this._infoCard.visible=!1)}},{key:"_OnUserRemoved",value:function _OnUserRemoved(e){var t=this._usermap.Get(e);t&&(this._usermap.Remove(e),t.Release(),0==this._usermap.count?this._infoCard.visible=!0:this._infoCard.visible=!1)}},{key:"_OnUserUpdated",value:function _OnUserUpdated(e){this._OnInfosUpdated()}},{key:"_OnInfosUpdated",value:function _OnInfosUpdated(){var e="Add some users to start !",t="";switch(i.env.APP.database._userStatuses){case _.STATE_NONE:case _.STATE_INVALID:e="Need some more valid profiles...";break;case _.STATE_LOADING:e="Loading...";break;case _.STATE_READY:var s=i.env.APP.database._currentOverlap.length;t="".concat(s," products in common");var a=i.env.APP.database._filteredCount;e=a>0?"".concat(a," games matches filters"):"0 games matches filters";break;case _.STATE_INVALID:e="Something went wrong"}}},{key:"_CopyUsersToClipboard",value:function _CopyUsersToClipboard(){navigator.clipboard.writeText(JSON.stringify(i.env.APP.database._GetUserJSONData()))}}]),UserListExplorer}(n.Explorer);e.exports=c,a.Register("sgf-userlist",c)},{9:6,1:13,8:14,}],19:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n=i.uiworkspace,l=__r__(16),d=__r__(17),h=function(e){_inherits(MainLayout,e);var t=_createSuper(MainLayout);function MainLayout(){return _classCallCheck(this,MainLayout),t.call(this)}return _createClass(MainLayout,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(MainLayout.prototype),"_Init",this).call(this)}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{background:'url("'.concat(i.style.URLImgs("bg.png"),'")'),"background-size":"cover"},".header":{height:"0"},".shelf":{},".workspace":{}},_get(_getPrototypeOf(MainLayout.prototype),"_Style",this).call(this))}},{key:"_Render",value:function _Render(){new a.manipulators.Grid(this,["max-content",0],["max-content",0]);var e=s.El("div",{class:"header"},this);new a.manipulators.GridItem(e,1,1,2,1),this.header=e;var t=this.Add(d,"shelf");t.nav.size=a.FLAGS.SIZE_L,t.nav.defaultWidgetOptions={variant:a.FLAGS.MINIMAL},new a.manipulators.GridItem(t,1,2,1,1),this.shelf=t}}]),MainLayout}(a.views.Layer);e.exports=h,a.Register("toolbox-main-layout",h)},{17:20,16:24,}],20:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n=function(e){_inherits(MainShelf,e);var t=_createSuper(MainShelf);function MainShelf(){return _classCallCheck(this,MainShelf),t.call(this)}return _createClass(MainShelf,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(MainShelf.prototype),"_Init",this).call(this)}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{}},_get(_getPrototypeOf(MainShelf.prototype),"_Style",this).call(this))}}]),MainShelf}(i.uilib.views.Shelf);e.exports=n,a.Register("toolbox-main-shelf",n)},{}],21:[function(__r__,e,t){var i=window.nkmjs[0],s=i.ui,a=i.common,n=i.app,l=__r__(16),d=__r__(18),h=__r__(19),_=__r__(20),c=function(e){_inherits(SteamGameFinder,e);var t=_createSuper(SteamGameFinder);function SteamGameFinder(){return _classCallCheck(this,SteamGameFinder),t.call(this)}return _createClass(SteamGameFinder,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(SteamGameFinder.prototype),"_Init",this).call(this),this._fiftyYearsAgo=((Date.now()-15768e8)/1e3).toFixed(),document.cookie='wants_mature_content="1"',document.cookie="birthtime=".concat(this._fiftyYearsAgo),document.cookie="path=/",document.cookie="max-age=315360000",this._layers=[{id:"mainLayout",cl:__r__(21)}]}},{key:"database",get:function get(){return this._DB}},{key:"AppReady",value:function AppReady(){var e,t;_get(_getPrototypeOf(SteamGameFinder.prototype),"AppReady",this).call(this),this._DB=new _,this._mainCatalog=i.data.catalogs.CreateFrom(_defineProperty({},a.IDS.NAME,"SGF"),[(e={},_defineProperty(e,a.IDS.NAME,"Friends"),_defineProperty(e,a.IDS.ICON,"view-list"),_defineProperty(e,s.IDS.VIEW_CLASS,d.UserList),e),(t={},_defineProperty(t,a.IDS.NAME,"Filters"),_defineProperty(t,a.IDS.ICON,"search"),_defineProperty(t,s.IDS.VIEW_CLASS,d.GameFilters),t)]);var n=this.mainLayout.shelf;n.catalog=this._mainCatalog,n.RequestView(0),this._gamesList=this.mainLayout.Add(l.GamesList,"workspace"),new s.manipulators.GridItem(this._gamesList,2,2,1,1);var h=i.env.prefs.Get("userlist",null);if(h)for(var c=0;c<h.length;c++){var u=h[c],p;this._DB.GetUser(u.id).active=u.active}}},{key:"_RequestFriendList",value:function _RequestFriendList(e){var t={orientation:s.FLAGS.HORIZONTAL,placement:s.FLAGS.LEFT,title:"Friendlist",user:e,contentClass:l.FriendsList};i.actions.Emit(i.uilib.REQUEST.DRAWER,t,this)}},{key:"_429",value:function _429(){var e;i.dialog.Push((_defineProperty(e={},s.IDS.TITLE,"Ewwww."),_defineProperty(e,s.IDS.MESSAGE,"It appears that Steam has temporarily locked out your IP from requesting data.</br><b>Wait a few minutes and come back.</b>"),_defineProperty(e,"actions",[{label:"Ok"}]),_defineProperty(e,"origin",this),_defineProperty(e,s.IDS.ICON,"warning"),_defineProperty(e,s.IDS.FLAVOR,i.common.FLAGS.WARNING),_defineProperty(e,s.IDS.VARIANT,s.FLAGS.FRAME),e))}}]),SteamGameFinder}(n.AppBase);e.exports=c},{19:2,20:10,18:17,21:19,16:24,}],22:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n=__r__(9),l=__r__(22),d=function(e){_inherits(FriendsListView,e);var t=_createSuper(FriendsListView);function FriendsListView(){return _classCallCheck(this,FriendsListView),t.call(this)}return _createClass(FriendsListView,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(FriendsListView.prototype),"_Init",this).call(this),this._Bind(this._OnFriendlistLoadSuccess),this._Bind(this._OnFriendlistLoadError),this._friendlist=new Array}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{"min-width":"350px",width:"66%","background-color":"rgba(61,61,61,0.5)","backdrop-filter":"blur(10px)"},".header":{flex:"0 0 100px"},".card-ctnr":{flex:"1 1 auto",display:"flex","flex-flow":"row wrap",padding:"0px 8px 0px 4px","overflow-x":"hidden","overflow-y":"overlay"},".user-card":{flex:"1 1 250px",margin:"4px"},".info-card":{flex:"1 1 auto",margin:"4px","--size":"100%"}},_get(_getPrototypeOf(FriendsListView.prototype),"_Style",this).call(this))}},{key:"_Cleanup",value:function _Cleanup(){_get(_getPrototypeOf(FriendsListView.prototype),"_Cleanup",this).call(this),console.log("Cleanup !")}},{key:"_Render",value:function _Render(){_get(_getPrototypeOf(FriendsListView.prototype),"_Render",this).call(this),this._header=s.dom.El("div",{class:"header"},this._body),this._cardCtnr=s.dom.El("div",{class:"card-ctnr"},this._body),this._infoCard=this.Add(i.uilib.cards.Icon,"info-card",this._body),this._infoCard._mediaPlacement.Set(i.ui.FLAGS.TOP)}},{key:"_OnDataChanged",value:function _OnDataChanged(e){if(_get(_getPrototypeOf(FriendsListView.prototype),"_OnDataChanged",this).call(this,e),this._ClearFriendlist(),this._data){var t=this._data.GetOption("user",null);t&&(this._SetInfosLoading(),i.io.Read("https://steamcommunity.com/profiles/".concat(t.profileID64,"/friends"),{cl:i.io.resources.TextResource},{success:this._OnFriendlistLoadSuccess,error:this._OnFriendlistLoadError}))}}},{key:"_OnFriendlistLoadSuccess",value:function _OnFriendlistLoadSuccess(e){var t=e.content.split('<div class="selectable friend_block_');if(0!=t.length){for(var s=0,a=t.length;s<a;s++){var d=t[s];try{var h=d.split('data-steamid="')[1].split('"')[0],_=d.split('<div class="player_avatar')[1].split('<img src="')[1].split('"')[0],c=d.split('<div class="friend_block_content')[1].split(">")[1].split("<")[0],u=new l;u._profileID64=h,u._personaID=c,u._avatarURL=_,u.existingUser=i.env.APP.database.FindUser(h);var p=this.Add(n.FriendCard,"user-card",this._cardCtnr);p.data=u,this._friendlist.push(p)}catch(e){}}0==this._friendlist.length?this._SetInfosError():this._SetInfosNone()}}},{key:"_OnFriendlistLoadError",value:function _OnFriendlistLoadError(e){e.response&&429==e.response.status&&ENV.APP._429()}},{key:"_SetInfosLoading",value:function _SetInfosLoading(){this._infoCard.visible=!0,this._infoCard.icon="search",this._infoCard.title="Loading",this._infoCard.subtitle="loading friendlist, please be patient",this._infoCard.flavor=null,this._infoCard.variant=a.FLAGS.MINIMAL}},{key:"_SetInfosError",value:function _SetInfosError(){this._infoCard.visible=!0,this._infoCard.icon="error",this._infoCard.title="Nope !",this._infoCard.subtitle="Could not retrieve friend infos.",this._infoCard.flavor=i.common.FLAGS.ERROR,this._infoCard.variant=a.FLAGS.MINIMAL}},{key:"_SetInfosNone",value:function _SetInfosNone(){this._infoCard.visible=!1}},{key:"_ClearFriendlist",value:function _ClearFriendlist(){for(var e=0;e<this._friendlist.length;e++)this._friendlist[e].Release();this._friendlist.length=0}},{key:"_CleanUp",value:function _CleanUp(){this._ClearFriendlist(),_get(_getPrototypeOf(FriendsListView.prototype),"_CleanUp",this).call(this)}}]),FriendsListView}(i.uilib.overlays.Drawer);e.exports=d,a.Register("sgf-friendslist",d)},{9:6,22:11,}],23:[function(__r__,e,t){var i=window.nkmjs[0],s=i.utils,a=i.ui,n=__r__(9),l=__r__(8),d=function(e){_inherits(GamesListView,e);var t=_createSuper(GamesListView);function GamesListView(){return _classCallCheck(this,GamesListView),t.call(this)}return _createClass(GamesListView,[{key:"_Init",value:function _Init(){_get(_getPrototypeOf(GamesListView.prototype),"_Init",this).call(this),this._appmap=new i.collections.Dictionary,this._appctrls=new Array,i.env.APP.database.Watch(l.GAME_ADDED,this._OnAppAdded,this),i.env.APP.database.Watch(l.GAME_REMOVED,this._OnAppRemoved,this),i.env.APP.database.Watch(l.INFOS_UPDATED,this._OnInfosUpdated,this),this._gameListQueue=new Array,i.common.time.TIME.Watch(i.common.SIGNAL.TICK,this._OnTick,this),i.common.Preload(n.GameCard,1e3)}},{key:"_Style",value:function _Style(){return i.style.Extends({":host":{display:"flex","flex-flow":"column nowrap"},".header":{position:"sticky",display:"flex","flex-flow":"row wrap",padding:"20px"},".info-card":{flex:"1 1 auto"},".card-ctnr":{flex:"1 1 auto",display:"flex","align-content":"start","flex-flow":"row wrap",padding:"8px 8px 0px 4px","overflow-x":"hidden","overflow-y":"overlay"},".game-card":{flex:"1 0 auto",margin:"4px"}},_get(_getPrototypeOf(GamesListView.prototype),"_Style",this).call(this))}},{key:"_Cleanup",value:function _Cleanup(){_get(_getPrototypeOf(GamesListView.prototype),"_Cleanup",this).call(this),console.log("Cleanup !")}},{key:"_Render",value:function _Render(){_get(_getPrototypeOf(GamesListView.prototype),"_Render",this).call(this),this._cardCtnr=s.dom.El("div",{class:"card-ctnr"},this),this._header=s.dom.El("div",{class:"header"},this),this._infoCard=this.Add(n.InfoCard,"info-card",this._header)}},{key:"_OnAppAdded",value:function _OnAppAdded(e){var t;this._appmap.Get(e)||this._gameListQueue.includes(e)||this._gameListQueue.push(e)}},{key:"_AddApp",value:function _AddApp(e){var t=this._appmap.Get(e);t||((t=this.Add(n.GameCard,"game-card",this._cardCtnr)).data=e,this._appmap.Set(e,t),this._appctrls.push(t),t.visible=e.shouldShow)}},{key:"_OnAppRemoved",value:function _OnAppRemoved(e){this._RemoveApp(e)}},{key:"_RemoveApp",value:function _RemoveApp(e){var t=this._appmap.Get(e);t&&(this._appmap.Remove(e),this._appctrls.splice(this._appctrls.indexOf(t),1),t.Release())}},{key:"_OnInfosUpdated",value:function _OnInfosUpdated(){var e=i.env.APP.database;if(0==e._userReadyList.count||0==e._filteredCount)for(var t=0,s=this._appctrls.length;t<s;t++)this._appctrls[t].visible=!1;else for(var a,t=0,s=this._appctrls.length;t<s;t++)(a=this._appctrls[t]).visible=a.data.shouldShow}},{key:"_OnTick",value:function _OnTick(){var e=10,t=this._gameListQueue.length;t>e&&(t=e);for(var i=0;i<t;i++){var s=this._gameListQueue.shift();this._AddApp(s)}}}]),GamesListView}(a.views.View);e.exports=d,a.Register("sgf-gameslist",d)},{9:6,8:14,}],24:[function(__r__,e,t){e.exports={GamesList:__r__(23),FriendsList:__r__(24)}},{24:22,23:23}]},{},[1]);